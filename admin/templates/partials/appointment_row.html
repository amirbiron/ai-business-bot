<tr id="appointment-row-{{ appt.id }}">
    <td data-label="מזהה">{{ appt.id }}</td>
    <td data-label="לקוח">
        <div>
            <span class="fw-semibold" style="color: var(--text-primary);">{{ appt.username }}</span>
            {% if appt.telegram_username %}
            <br>
            <a class="text-small" href="https://t.me/{{ appt.telegram_username }}" target="_blank" rel="noopener">
                @{{ appt.telegram_username }}
            </a>
            {% else %}
            <br><span class="text-small text-muted">ללא שם משתמש בטלגרם</span>
            {% endif %}
        </div>
    </td>
    <td data-label="שירות">{{ appt.service }}</td>
    <td data-label="תאריך">{{ appt.preferred_date }}</td>
    <td data-label="שעה">{{ appt.preferred_time }}</td>
    <td data-label="הערות">{{ appt.notes }}</td>
    <td data-label="סטטוס">
        {% if appt.status == 'pending' %}
        <span class="badge badge-warning">ממתין</span>
        {% elif appt.status == 'confirmed' %}
        <span class="badge badge-success">מאושר</span>
        {% elif appt.status == 'cancelled' %}
        <span class="badge badge-danger">בוטל</span>
        {% endif %}
    </td>
    <td data-label="נוצר" class="text-small text-muted">{{ appt.created_at|il_datetime }}</td>
    <td data-label="פעולות">
        {% if appt.status == 'pending' %}
        <div class="actions-cell">
            <input type="text"
                   name="owner_message"
                   id="owner-msg-{{ appt.id }}"
                   class="form-control form-control-sm mb-1"
                   placeholder="הודעה אישית (אופציונלי)"
                   style="min-width: 160px;">
            <div class="d-flex gap-1">
                <button class="btn btn-success btn-sm"
                        hx-post="/appointments/{{ appt.id }}/update"
                        hx-vals='{"status": "confirmed"}'
                        hx-include="#owner-msg-{{ appt.id }}"
                        hx-target="#appointment-row-{{ appt.id }}"
                        hx-swap="outerHTML swap:0.2s">
                    <i class="bi bi-check-lg"></i> אשר
                </button>
                <button class="btn btn-outline-danger btn-sm"
                        hx-post="/appointments/{{ appt.id }}/update"
                        hx-vals='{"status": "cancelled"}'
                        hx-include="#owner-msg-{{ appt.id }}"
                        hx-target="#appointment-row-{{ appt.id }}"
                        hx-swap="outerHTML swap:0.2s">
                    <i class="bi bi-x-lg"></i> בטל
                </button>
            </div>
        </div>
        {% endif %}
    </td>
</tr>
