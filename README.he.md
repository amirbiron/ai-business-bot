
# צ'אטבוט AI לעסקים

[![גרסת Python](https://img.shields.io/badge/python-3.9+-blue.svg)](https://www.python.org/)
[![רישיון](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

מערכת צ'אטבוט עסקי מלאה ומוכנה לשימוש מבוססת בינה מלאכותית ב-Python. פרויקט זה מספק תבנית לעסקים ליצור צ'אטבוט שירות לקוחות משלהם עם ממשק טלגרם, מנוע ידע מבוסס RAG, ופאנל ניהול אינטרנטי לניהול קל.

המערכת מעוצבת עם ארכיטקטורת שלוש שכבות כדי להבטיח שהתשובות מדויקות, רלוונטיות, ומבוססות על מאגר הידע האמיתי של העסק.

![צילום מסך פאנל ניהול](https://i.imgur.com/example.png) <!-- Placeholder for a real screenshot -->

## תכונות

- **ממשק בוט טלגרם**: לקוחות מתקשרים עם הבוט בצורה טבעית ושיחתית בטלגרם.
- **יצירה מתקדמת מבוססת אחזור (RAG)**: הבוט עונה על שאלות בהתבסס על מאגר ידע מקומי, מה שמבטיח דיוק ומונע המצאת מידע.
- **פאנל ניהול אינטרנטי**: ממשק אינטרנט פשוט ומאובטח לבעלי עסקים לניהול מאגר הידע, צפייה בשיחות וטיפול בבקשות לקוחות.
- **תשובות עם ציטוט מקורות**: הבוט נדרש לצטט את המקורות שלו, מה שמספק שקיפות ומנגנון לבקרת איכות.
- **פעולות עסקיות מרכזיות**: כפתורים מוכנים מראש לפעולות נפוצות כמו "קביעת פגישה", "מחירון", "שליחת מיקום" ו-"שיחה עם נציג".
- **היסטוריית שיחות**: הבוט שומר הקשר עבור כל משתמש, מה שמאפשר שאלות המשך טבעיות יותר.
- **התראות**: בעלי עסקים מקבלים התראות טלגרם בזמן אמת לבקשות נציג והזמנות פגישות חדשות.
- **התקנה ופריסה קלה**: הפרויקט מעוצב כך שיהיה קל להתקנה והרצה עם תצורה מינימלית.

## ארכיטקטורה

המערכת בנויה על ארכיטקטורת שלוש שכבות כדי להבטיח תשובות אמינות ובאיכות גבוהה:

### שכבה A: מערכת והתנהגות

זוהי האישיות המרכזית ומערכת הכללים של הבוט. הנחיית מערכת (`config.py`) מגדירה כיצד הבוט צריך להתנהג:

> "אתה נציג שירות לקוחות ידידותי ומקצועי עבור [שם העסק]. ענה רק על סמך המידע בהקשר שסופק. לעולם אל תמציא מידע. אם ההקשר לא מכיל מספיק מידע, אמור שתעביר לנציג אנושי..."

שכבה זו מבטיחה שהבוט נשאר נאמן למותג ועוקב אחר כללים תפעוליים קריטיים.

### שכבה B: הקשר ואחזור (RAG)

במקום לדחוף את כל המידע העסקי להנחיה ענקית, המערכת משתמשת בצינור RAG קל משקל:

1.  **מאגר ידע**: מידע עסקי (שירותים, מחירים, מדיניות, שאלות נפוצות וכו') מאוחסן במאגר נתונים מקומי SQLite.
2.  **חלוקה לקטעים**: כל רשומת מאגר ידע מפוצלת לקטעים קטנים בעלי משמעות סמנטית.
3.  **הטמעה**: כל קטע מומר לווקטור הטמעה באמצעות מודל `text-embedding-3-small` של OpenAI.
4.  **מאגר וקטורים**: ההטמעות מאוחסנות באינדקס FAISS לחיפוש דמיון יעיל.
5.  **אחזור**: כאשר לקוח שואל שאלה, המערכת מטמיעה את השאילתא ומחפשת באינדקס FAISS כדי למצוא את 5-15 הקטעים הרלוונטיים ביותר.
6.  **הזרקה**: רק הקטעים הרלוונטיים הללו מוזרקים להנחיה שנשלחת ל-LLM, ומספקים הקשר ממוקד לתשובה.

גישה זו יעילה, ניתנת להרחבה, ומשפרת באופן דרמטי את הרלוונטיות והדיוק של תשובות הבוט.

### שכבה C: בדיקת איכות

כדי להבטיח שהבוט מקפיד על כלל "ענה רק ממקורות", נעשית בדיקת איכות פשוטה אך יעילה על כל תשובה:

1.  הנחיית המערכת מחייבת את ה-LLM לצטט את המקור שלו (למשל, "מקור: מחירון קיץ 2025").
2.  לאחר שה-LLM יוצר תשובה, בדיקת Regex (`llm.py`) מאמתת שציטוט מקור קיים.
3.  אם הציטוט חסר, התשובה נמחקת, והודעת גיבוי בטוחה נשלחת במקום: "אין לי את המידע הזה כרגע. אני אעביר אותך לנציג אנושי..."

זה פועל כמחסום אחרון, שמונע מהבוט לספק מידע לא מאומת.

## מחסנית טכנולוגית

-   **Backend**: Python 3.9+
-   **בוט טלגרם**: `python-telegram-bot`
-   **פאנל ניהול אינטרנטי**: Flask
-   **LLM**: OpenAI API (`gpt-4.1-mini`)
-   **RAG / מאגר וקטורים**: FAISS (`faiss-cpu`)
-   **מאגר נתונים**: SQLite
-   **תצורה**: `python-dotenv`

## מבנה הפרויקט

```
./
├── ai_chatbot/           # חבילת האפליקציה (קנונית)
│   ├── admin/            # פאנל ניהול Flask (templates/static נמצאים כאן)
│   ├── bot/              # בוט טלגרם
│   ├── rag/              # מנוע RAG (chunking/embeddings/vector store)
│   ├── config.py         # תצורה
│   ├── database.py       # גישה ל-SQLite
│   ├── llm.py            # אינטגרציית LLM (שכבות A, B, C)
│   └── main.py           # ראנר ראשי
├── data/                 # קבצי נתונים (מאגר נתונים, אינדקס FAISS)
├── main.py               # wrapper תואם-לאחור (מריץ ai_chatbot.main)
├── config.py             # wrapper תואם-לאחור
├── database.py           # wrapper תואם-לאחור
├── llm.py                # wrapper תואם-לאחור
├── openai_client.py      # wrapper תואם-לאחור
├── seed_data.py          # סקריפט לזריעת נתוני דמו
├── requirements.txt      # תלויות Python
└── .env.example          # קובץ דוגמה למשתני סביבה
```

## התקנה והגדרה

בצע את השלבים הבאים כדי להפעיל את מערכת הצ'אטבוט באופן מקומי.

### 1. דרישות מוקדמות

-   Python 3.9 ומעלה
-   מפתח API של OpenAI
-   טוקן בוט טלגרם מ-BotFather
-   מזהה צ'אט טלגרם האישי שלך (להתראות)

### 2. שכפול המאגר

```bash
git clone https://github.com/amirbiron/ai-business-bot.git
cd ai-business-bot
```

### 3. התקנת תלויות

צור סביבה וירטואלית והתקן את החבילות הנדרשות:

```bash
python -m venv venv
source venv/bin/activate  # ב-Windows, השתמש ב-`venv\Scripts\activate`
pip install -r requirements.txt
```

### 4. הגדרת משתני סביבה

העתק את קובץ הדוגמה `.env` ומלא את האישורים שלך:

```bash
cp .env.example .env
```

עכשיו, ערוך את קובץ ה-`.env`:

```dotenv
# קבל את זה מ-BotFather בטלגרם
TELEGRAM_BOT_TOKEN="YOUR_TELEGRAM_BOT_TOKEN"

# קבל את מזהה הצ'אט האישי שלך מבוט כמו @userinfobot
TELEGRAM_OWNER_CHAT_ID="YOUR_TELEGRAM_CHAT_ID"

# אישורים לכניסה לפאנל הניהול
ADMIN_USERNAME="admin"
ADMIN_PASSWORD="your_secure_password"

# מפתח סודי לניהול סשן Flask (שנה למחרוזת אקראית)
ADMIN_SECRET_KEY="a_very_long_and_random_string_for_security"

# שם העסק שלך
BUSINESS_NAME="סלון היופי של דנה"
```

### 5. זריעת מאגר הנתונים ובניית האינדקס

הפרויקט מגיע עם נתוני דמו לעסק פיקטיבי, "סלון היופי של דנה". הרץ את סקריפט הזריעה כדי למלא את מאגר הנתונים וליצור את אינדקס ה-RAG הראשון.

```bash
python -m main --seed
```

זה יבצע:
1.  יצירת קובץ SQLite `chatbot.db`.
2.  מילוי שלו עם שירותים, מחירים, מדיניות וכו'.
3.  יצירת קטעים, יצירת הטמעות ובניית ה-`faiss_index`.

## הפעלת האפליקציה

ניתן להפעיל את בוט הטלגרם ואת פאנל הניהול האינטרנטי יחד או בנפרד.

### הפעלת שניהם (בוט + פאנל ניהול)

זהו המצב ברירת המחדל. הוא מתחיל את פאנל הניהול Flask בחוט רקע ואת בוט הטלגרם בחוט הראשי.

```bash
python -m main
```

-   **בוט טלגרם**: יתחיל לבדוק הודעות.
-   **פאנל ניהול**: יהיה זמין ב-`http://127.0.0.1:5000` (ברירת מחדל מקומית).

### הפעלת בוט הטלגרם בלבד

```bash
python -m main --bot
```

### הפעלת פאנל הניהול בלבד

```bash
python -m main --admin
```

## כיצד להשתמש

### 1. שיחה עם הבוט

פתח טלגרם והתחל שיחה עם הבוט שיצרת עם BotFather. תוכל לשאול אותו שאלות כמו:

-   "מה השעות שלכם ביום רביעי?"
-   "כמה עולה תספורת לגברים?"
-   "האם אתם עושים בליאז'?"
-   "מה מדיניות הביטול שלכם?"

השתמש בכפתורים כדי לקבוע פגישה, לראות את המחירון או לקבל את המיקום.

### 2. שימוש בפאנל הניהול

נווט ל-`http://localhost:5000` בדפדפן שלך. התחבר עם `ADMIN_USERNAME` ו-`ADMIN_PASSWORD` שהגדרת בקובץ ה-`.env` שלך.

מפאנל הניהול, תוכל:

-   **לוח בקרה**: ראה סטטיסטיקות במבט חטוף.
-   **מאגר ידע**: הוסף, ערוך או מחק מידע עסקי. **זכור ללחוץ על "בניית אינדקס מחדש"** לאחר ביצוע שינויים כדי לעדכן את הידע של הבוט.
-   **שיחות**: צפה ביומנים של כל השיחות עם הבוט.
-   **בקשות נציג**: ראה רשימה של לקוחות שביקשו לדבר עם אדם.
-   **פגישות**: נהל בקשות פגישה נכנסות.

## העלאה ל-GitHub

פרויקט זה מוכן להעלאה למאגר GitHub משלך.

```bash
# ודא שאתה בתיקיית שורש הפרויקט

# הוסף את כל הקבצים החדשים
git add .

# בצע commit לשינויים
git commit -m "feat: Add initial AI business chatbot project"

# העלה למאגר שלך
git push origin main
```

## רישיון

פרויקט זה מורשה תחת רישיון MIT. ראה את קובץ ה-[LICENSE](LICENSE) לפרטים.

